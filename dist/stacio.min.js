var aa="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,d){a!=Array.prototype&&a!=Object.prototype&&(a[b]=d.value)},ba="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function ca(a,b){if(b){var d=ba;a=a.split(".");for(var c=0;c<a.length-1;c++){var e=a[c];e in d||(d[e]={});d=d[e]}a=a[a.length-1];c=d[a];b=b(c);b!=c&&null!=b&&aa(d,a,{configurable:!0,writable:!0,value:b})}}
ca("Math.hypot",function(a){return a?a:function(a,d,c){a=Number(a);d=Number(d);var b,f=Math.max(Math.abs(a),Math.abs(d));for(b=2;b<arguments.length;b++)f=Math.max(f,Math.abs(arguments[b]));if(1E100<f||1E-100>f){if(!f)return f;a/=f;d/=f;var h=a*a+d*d;for(b=2;b<arguments.length;b++){var l=Number(arguments[b])/f;h+=l*l}return Math.sqrt(h)*f}h=a*a+d*d;for(b=2;b<arguments.length;b++)l=Number(arguments[b]),h+=l*l;return Math.sqrt(h)}});function g(a,b,d,c){this.I=a;this.J=b;this.L=a+d;this.M=b+c;this.left=this.I;this.top=this.J;this.width=d;this.height=c;this.o=function(){return{x:(this.I+this.L)/2|0,y:(this.J+this.M)/2|0}};this.a=function(a){return this.I<=a.L&&this.L>=a.I&&this.J<=a.M&&this.M>=a.J}};function da(){this.j=!1;this.u=this.h=0}da.prototype.update=function(){this.j?(this.h++,this.u=0):(this.h=0,this.u++)};function ea(a){this.keys=Array(256);for(var b=0;256>b;b++)this.keys[b]=new da;a.tabIndex=0;var d=this;a.addEventListener("keydown",function(a){fa(d,a,!0)});a.addEventListener("keyup",function(a){fa(d,a,!1)})}ea.prototype.update=function(){for(var a=0;256>a;a++)this.keys[a].update()};function fa(a,b,d){b.stopPropagation();b.preventDefault();b=b.keyCode;0<=b&&256>b&&(a.keys[b].j=d)};function ha(a){this.a=a;this.F=this.D=this.c=this.b=this.y=this.x=0;this.j=!1;this.u=this.h=0;a=a.b;var b=this.g.bind(this);a.addEventListener("mousedown",b);a.addEventListener("mouseup",b);a.addEventListener("mousemove",b);a.addEventListener("contextmenu",b);b=this.O.bind(this);a.addEventListener("touchstart",b);a.addEventListener("touchend",b);a.addEventListener("touchcancel",b);a.addEventListener("touchmove",b)}
ha.prototype.update=function(){this.D=this.x-this.b;this.F=this.y-this.c;this.b=this.x;this.c=this.y;this.j?(this.h++,this.u=0):(this.h=0,this.u++)};ha.prototype.g=function(a){a.stopPropagation();a.preventDefault();ia(this,a.clientX,a.clientY);"mousedown"===a.type&&(this.j=!0,this.a.b.focus());"mouseup"===a.type&&(this.j=!1)};ha.prototype.O=function(a){a.stopPropagation();a.preventDefault();0<a.touches.length?(a=a.touches[0],ia(this,a.clientX,a.clientY),this.j=!0):this.j=!1};
function ia(a,b,d){var c=a.a.b.getBoundingClientRect(),e=c.width/c.height;if(.01<e-a.a.aspectRatio){var f=a.a.aspectRatio*c.height;c=new g(Math.floor((c.width-f)/2),0,f,c.height)}-.01>e-a.a.aspectRatio&&(e=c.width/a.a.aspectRatio,c=new g(0,Math.floor((c.height-e)/2),c.width,e));a.x=a.a.width*(b-c.left)/c.width|0;a.y=a.a.height*(d-c.top)/c.height|0}function ja(a,b,d,c){return k.x>=a&&k.x<a+d&&k.y>=b&&k.y<b+c};var ka=[0,-1,1,0],la=[-1,0,0,1],ma=[1,1,1,1];function na(a,b,d){b=oa(a,a.VERTEX_SHADER,b);d=oa(a,a.FRAGMENT_SHADER,d);var c=a.createProgram();a.attachShader(c,b);a.attachShader(c,d);a.linkProgram(c);return c}function oa(a,b,d){b=a.createShader(b);a.shaderSource(b,d);a.compileShader(b);return b}
function pa(a){var b=a.createTexture();a.bindTexture(a.TEXTURE_2D,b);var d=a.RGBA,c=a.RGBA,e=a.UNSIGNED_BYTE;a.texImage2D(a.TEXTURE_2D,0,d,1,1,0,c,e,new Uint8Array([0,0,0,0]));var f=new Image;f.onload=function(){a.bindTexture(a.TEXTURE_2D,b);a.texImage2D(a.TEXTURE_2D,0,d,c,e,f);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,
a.NEAREST);a.generateMipmap(a.TEXTURE_2D);b.loaded=!0;b.width=f.width;b.height=f.height};f.src="img/graphics.png";return b};function qa(a,b){this.x=a;this.y=b;this.ta=0;this.A=!0;this.pa=this.visible=!1;this.ma=this.K=0;this.oa=null}function ra(){this.height=this.width=256;this.qa=null;this.P=new Uint8Array(262144);this.wa=new Float32Array([256,256]);this.clear()}ra.prototype.clear=function(){for(var a=0;a<this.P.length;a++)this.P[a]=255};
ra.prototype.na=function(a){this.qa=a.createTexture();a.bindTexture(a.TEXTURE_2D,this.qa);a.texImage2D(a.TEXTURE_2D,0,a.RGBA,this.width,this.height,0,a.RGBA,a.UNSIGNED_BYTE,this.P);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE)};
function sa(){this.height=this.width=256;this.f=Array(256);this.b=Array(3);this.U=new Float32Array(2);for(var a=0;256>a;a++){this.f[a]=Array(256);for(var b=0;256>b;b++)this.f[a][b]=new qa(b,a)}for(a=0;3>a;a++)this.b[a]=new ra}
sa.prototype.na=function(a){this.O=a;this.ia=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,this.ia);a.bufferData(a.ARRAY_BUFFER,new Float32Array([-1,-1,0,1,1,-1,1,1,1,1,1,0,-1,-1,0,1,1,1,1,0,-1,1,0,0]),a.STATIC_DRAW);this.a=na(a,"precision highp float;attribute vec2 position;attribute vec2 texture;varying vec2 pixelCoord;varying vec2 texCoord;uniform vec2 viewOffset;uniform vec2 viewportSize;uniform vec2 mapSize;void main(void) {   pixelCoord = (texture * viewportSize) + viewOffset;   texCoord = pixelCoord / mapSize / 16.0;   gl_Position = vec4(position, 0.0, 1.0);}","precision highp float;varying vec2 pixelCoord;varying vec2 texCoord;uniform sampler2D tiles;uniform sampler2D sprites;void main(void) {   vec4 tile = texture2D(tiles, texCoord);   if(tile.x == 1.0 && tile.y == 1.0) { discard; }   vec2 spriteOffset = floor(tile.xy * 256.0) * 16.0;   vec2 spriteCoord = mod(pixelCoord, 16.0);   gl_FragColor = texture2D(sprites, (spriteOffset + spriteCoord) / 1024.0);   gl_FragColor.a = tile.a;}");
this.ha=a.getAttribLocation(this.a,"position");this.ca=a.getAttribLocation(this.a,"texture");this.va=a.getUniformLocation(this.a,"viewportSize");this.ua=a.getUniformLocation(this.a,"viewOffset");this.ja=a.getUniformLocation(this.a,"mapSize");this.la=a.getUniformLocation(this.a,"tiles");this.ka=a.getUniformLocation(this.a,"sprites");for(var b=0;b<this.b.length;b++)this.b[b].na(a)};
function n(a,b,d,c){var e=q;e.f[b][a].ta=d;e.f[b][a].A=c;c=e.b[0];a=4*(b*c.width+a);c.P[a]=0===d?255:(d-1)%64|0;c.P[a+1]=0===d?255:(d-1)/64|0}function r(a,b,d){return 0>b||b>=a.width||0>d||d>=a.height?null:a.f[d][b]}function ta(a,b){return(a=r(q,a,b))?a.ta:81}function u(a,b){a=r(q,a,b);return!a||a.A}sa.prototype.G=function(a,b){return(a=r(this,a,b))&&a.visible};sa.prototype.G=function(a,b){return a<this.w||a>this.c||b<this.B||b>this.g?!1:this.f[b][a].visible};function ua(){var a=q,b=x.x/16|0,d=x.y/16|0;a.$=b;a.ba=d;a.w=Math.max(0,b-12);a.B=Math.max(0,d-12);a.c=Math.min(a.width-1,b+12);a.g=Math.min(a.height-1,d+12);for(var c=a.B;c<=a.g;c++)for(var e=a.w;e<=a.c;e++)a.f[c][e].pa|=a.f[c][e].visible,a.f[c][e].visible=!1;a.f[d][b].visible=!0;va(a,1,1);wa(a,1,1);va(a,1,-1);wa(a,1,-1);va(a,-1,1);wa(a,-1,1);va(a,-1,-1);wa(a,-1,-1)}
function va(a,b,d){var c=[],e=[],f=1,h=0,l=0,t=0,m,p;for(p=a.ba+d;p>=a.B&&p<=a.g;p+=d,l=h,++f){var C=.5/f;var w=-1;var J=Math.floor(t*f+.5);for(m=a.$+J*b;J<=f&&m>=a.w&&m<=a.c;m+=b,++J,w=D){var F=!0;var X=!1;var O=J/f;var D=O+C;if(0<l)if(a.f[p-d][m].visible&&!a.f[p-d][m].A||a.f[p-d][m-b].visible&&!a.f[p-d][m-b].A)for(var v=0;v<l&&F;++v){if(w<=e[v]&&D>=c[v])if(a.f[p][m].A)if(w>=c[v]&&D<=e[v]){F=!1;break}else c[v]=Math.min(c[v],w),e[v]=Math.max(e[v],D),X=!0;else if(O>c[v]&&O<e[v]){F=!1;break}}else F=
!1;F&&(a.f[p][m].visible=!0,a.f[p][m].A&&(t>=w?t=D:X||(c[h]=w,e[h++]=D)))}}}
function wa(a,b,d){var c=[],e=[],f=1,h=0,l=0,t=0,m,p;for(m=a.$+b;m>=a.w&&m<=a.c;m+=b,l=h,++f){var C=.5/f;var w=-1;var J=Math.floor(t*f+.5);for(p=a.ba+J*d;J<=f&&p>=a.B&&p<=a.g;p+=d,++J,w=D){var F=!0;var X=!1;var O=J/f;var D=O+C;if(0<l)if(a.f[p][m-b].visible&&!a.f[p][m-b].A||a.f[p-d][m-b].visible&&!a.f[p-d][m-b].A)for(var v=0;v<l&&F;++v){if(w<=e[v]&&D>=c[v])if(a.f[p][m].A)if(w>=c[v]&&D<=e[v]){F=!1;break}else c[v]=Math.min(c[v],w),e[v]=Math.max(e[v],D),X=!0;else if(O>c[v]&&O<e[v]){F=!1;break}}else F=
!1;F&&(a.f[p][m].visible=!0,a.f[p][m].A&&(t>=w?t=D:X||(c[h]=w,e[h++]=D)))}}};function xa(a){this.O=a;var b=na(a,"uniform vec2 u_viewportSize;attribute vec2 a_position;attribute vec2 a_texCoord;attribute vec4 a_color;varying vec2 v_texCoord;varying vec4 v_color;void main() {vec2 zeroToOne = a_position / u_viewportSize;vec2 zeroToTwo = zeroToOne * 2.0;vec2 clipSpace = zeroToTwo - 1.0;gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);v_texCoord = a_texCoord;v_color = a_color;}","precision mediump float;uniform sampler2D u_image;varying vec2 v_texCoord;varying vec4 v_color;void main() {gl_FragColor = texture2D(u_image, v_texCoord);if (gl_FragColor.a < 0.1) discard;if (v_color.a > 0.5) gl_FragColor = v_color;}");
this.ja=b;this.la=a.getUniformLocation(b,"u_viewportSize");this.$=a.getAttribLocation(b,"a_position");this.ba=a.getAttribLocation(b,"a_texCoord");this.G=a.getAttribLocation(b,"a_color");this.B=new Float32Array(2);this.ca=a.createBuffer();this.ka=a.createBuffer();this.ha=a.createBuffer();this.aa=pa(a);this.b=new Float32Array(65536);this.a=0;this.c=new Float32Array(65536);this.g=0;this.U=new Uint8Array(65536);this.ia=new DataView(this.U.buffer);this.w=0}
function y(a,b,d,c){var e=z.c;a=a.toUpperCase().split("\n");for(var f=0;f<a.length;f++)for(var h=0;h<a[f].length;h++){var l=a[f].charCodeAt(h);33<=l&&127>=l&&ya(e,b+4*h,d+8*f,8*(l-33),0,8,10,c)}}
function ya(a,b,d,c,e,f,h,l,t,m){var p=a.aa;if(p.loaded){t=b+Math.abs(void 0!==t?t:f);m=d+(void 0!==m?m:h);var C=c/p.width,w=e/p.height;c=(c+f)/p.width;e=(e+h)/p.height;l=l||0;a.b[a.a++]=b;a.b[a.a++]=d;a.b[a.a++]=t;a.b[a.a++]=d;a.b[a.a++]=b;a.b[a.a++]=m;a.c[a.g++]=C;a.c[a.g++]=w;a.c[a.g++]=c;a.c[a.g++]=w;a.c[a.g++]=C;a.c[a.g++]=e;a.b[a.a++]=b;a.b[a.a++]=m;a.b[a.a++]=t;a.b[a.a++]=d;a.b[a.a++]=t;a.b[a.a++]=m;a.c[a.g++]=C;a.c[a.g++]=e;a.c[a.g++]=c;a.c[a.g++]=w;a.c[a.g++]=c;a.c[a.g++]=e;for(b=0;6>b;b++)a.ia.setUint32(a.w,
l,!1),a.w+=4}};function za(a){var b=a.getContext("webgl",{alpha:!1,antialias:!1});if(b){this.b=a;this.options={};this.O=b;this.aspectRatio=this.height=this.width=1;this.a={x:1,y:1};b.disable(b.DEPTH_TEST);b.enable(b.BLEND);b.blendFunc(b.SRC_ALPHA,b.ONE_MINUS_SRC_ALPHA);this.c=new xa(b);this.B=new ea(a);this.keys=this.B.keys;this.g=new ha(this);q=new sa;A=[];B=[];E=[];for(a=0;4>a;a++){B.push(Array(4));for(var d=0;4>d;d++)B[a][d]=null}for(a=0;10>a;a++){d={level:a,x:0,y:0,parent:null,N:0,children:[],ea:[]};if(0===
a)d.x=Math.floor(4*Math.random()),d.y=Math.floor(4*Math.random());else{var c=E[Math.floor(Math.random()*E.length)];c.children.push(d);c.N--;d.parent=c;0<c.x&&!B[c.y][c.x-1]&&(d.x=c.x-1,d.y=c.y);0<c.y&&!B[c.y-1][c.x]&&(d.x=c.x,d.y=c.y-1);3>c.x&&!B[c.y][c.x+1]&&(d.x=c.x+1,d.y=c.y);3>c.y&&!B[c.y+1][c.x]&&(d.x=c.x,d.y=c.y+1)}d.rect=new g(40*d.x,40*d.y,40,40);A.push(d);B[d.y][d.x]=d;E=[];for(d=0;d<A.length;d++)c=A[d],c.N=0,0<c.x&&!B[c.y][c.x-1]&&c.N++,0<c.y&&!B[c.y-1][c.x]&&c.N++,3>c.x&&!B[c.y][c.x+1]&&
c.N++,3>c.y&&!B[c.y+1][c.x]&&c.N++,0<c.N&&E.push(c)}for(a=0;a<A.length;a++){d=A[a];c=d.ea;var e=new g(d.rect.I+1,d.rect.o().y-2,5,5);G(e);c.push(e);e=new g(d.rect.L-5,d.rect.o().y-2,5,5);G(e);c.push(e);e=new g(d.rect.o().x-2,d.rect.J+1,5,5);G(e);c.push(e);e=new g(d.rect.o().x-2,d.rect.M-5,5,5);G(e);for(c.push(e);10>c.length;){e=new g(H(d.rect.I+2,d.rect.L-12-3),H(d.rect.J+2,d.rect.M-8-3),H(5,12),H(5,8));for(var f=!1,h=0;h<c.length;h++)if(e.a(c[h])){f=!0;break}f||(G(e),c.push(e))}for(e=c.length-1;0<
e;e--)h=Math.floor(Math.random()*(e+1)),f=c[e],c[e]=c[h],c[h]=f;for(e=1;e<c.length;e++)f=c[e].o(),h=c[e-1].o(),.5>Math.random()?(Aa(h.x,f.x,h.y),Ba(h.y,f.y,f.x)):(Ba(h.y,f.y,h.x),Aa(h.x,f.x,f.y));d.parent&&(d.parent.x<d.x?Aa(d.rect.I-3,d.rect.I+3,d.rect.o().y):d.parent.x>d.x?Aa(d.rect.L-3,d.rect.L+3,d.rect.o().y):d.parent.y<d.y?Ba(d.rect.J-3,d.rect.J+3,d.rect.o().x):d.parent.y>d.y&&Ba(d.rect.M-3,d.rect.M+3,d.rect.o().x))}for(a=0;256>a;a++)for(d=0;256>d;d++)u(d,a)&&(u(d,a+1)?0!==ta(d,a)&&0===ta(d,
a+1)?n(d,a,Ca(d,a),!0):u(d,a-1)&&u(d-1,a)&&u(d+1,a)&&u(d-1,a-1)&&u(d+1,a-1)&&u(d-1,a+1)&&u(d+1,a+1)||(c=Da(d,a),c=64*(1+(c?c.level:0)%6)+23,n(d,a,H(c,c+6),!0)):n(d,a,Ca(d,a),!0));x={i:0,name:"Player",x:16*A[0].ea[0].o().x,y:16*A[0].ea[0].o().y,D:0,F:0,direction:2,l:100,X:100,m:1,C:0,H:2,target:null,path:null,Y:0,da:100,sa:100,R:0,S:10,level:1,xa:[]};a={i:4,name:"Radio",x:x.x+32,y:x.y-32};d={i:2,name:"Blaster",x:x.x+32,y:x.y+32};I=[x];K=[a,d];L=[];M={x:0,y:0};N=null;for(a=0;a<A.length;a++)for(d=A[a],
c=d.ea,e=1;e<c.length;e++){f=c[e].o();h=d.level/3|1;for(var l=0;l<h;l++){var t=Ea(f.x,f.y);if(!t)break;I.push({i:1,level:d.level+1,name:"Alien ("+(d.level+1)+")",x:16*t.fa,y:16*t.ga,D:0,F:0,direction:2,l:10+5*d.level,X:10+5*d.level,m:1,C:0,H:4})}8===e&&K.push({i:3,name:"Blue Key",x:16*f.x+32,y:16*f.y+32})}ua();Fa(Ga[4]);q.na(b);window.addEventListener("resize",this.w.bind(this),!1);this.w();this.G()}}
za.prototype.w=function(){var a=window.innerWidth,b=window.innerHeight;var d=a>b?Math.max(1,Math.min(Math.floor(a/256),Math.floor(b/144))):Math.max(1,Math.min(Math.floor(a/144),Math.floor(b/256)));this.width=Math.round(a/d);this.height=Math.round(b/d);this.aspectRatio=this.width/this.height;this.a.x=this.width/2|0;this.a.y=this.height/2|0;this.b.width=this.width;this.b.height=this.height;this.b.style.left="0";this.b.style.top="0";this.b.style.width=a+"px";this.b.style.height=b+"px"};
za.prototype.G=function(){this.B.update();this.g.update();var a=this.O;a.viewport(0,0,this.width,this.height);a.clearColor(0,0,0,1);a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT);this.c.a=0;this.c.g=0;this.c.w=0;this.update&&this.update();a=this.c;var b=this.width,d=this.height;if(a.aa.loaded){var c=a.O;c.useProgram(a.ja);a.B[0]=b;a.B[1]=d;c.uniform2fv(a.la,a.B);c.activeTexture(c.TEXTURE0);c.bindTexture(c.TEXTURE_2D,a.aa);c.enableVertexAttribArray(a.$);c.bindBuffer(c.ARRAY_BUFFER,a.ca);c.bufferData(c.ARRAY_BUFFER,
a.b,c.DYNAMIC_DRAW);c.vertexAttribPointer(a.$,2,c.FLOAT,!1,0,0);c.enableVertexAttribArray(a.ba);c.bindBuffer(c.ARRAY_BUFFER,a.ka);c.bufferData(c.ARRAY_BUFFER,a.c,c.DYNAMIC_DRAW);c.vertexAttribPointer(a.ba,2,c.FLOAT,!1,0,0);c.enableVertexAttribArray(a.G);c.bindBuffer(c.ARRAY_BUFFER,a.ha);c.bufferData(c.ARRAY_BUFFER,a.U,c.DYNAMIC_DRAW);c.vertexAttribPointer(a.G,4,c.UNSIGNED_BYTE,!0,0,0);c.drawArrays(c.TRIANGLES,0,a.a/2)}requestAnimationFrame(this.G.bind(this))};
function P(a,b,d,c,e,f,h,l,t){ya(z.c,a,b,d,c,e,f,h,l,t)}function Q(a,b,d,c){y(a,b-4*a.length/2|0,d,c)};var Ha=[0,0,16,17,23],Ia=[1,5,28,23,27],Ja=[2,0,1,3];var q=null,A=null,B=null,E=null;function G(a){var b=a.I,d=a.L,c=a.M;for(a=a.J;a<c;a++)for(var e=b;e<d;e++)n(e,a,Ka(e,a),!1)}function Aa(a,b,d){for(var c=Math.min(a,b);c<=Math.max(a,b);c++)n(c,d,Ka(c,d),!1)}function Ba(a,b,d){for(var c=Math.min(a,b);c<=Math.max(a,b);c++)n(d,c,Ka(d,c),!1)}function H(a,b){return Math.floor(Math.random()*(b-a)+a)}function Da(a,b){a=a/40|0;b=b/40|0;return 0>a||4<=a||0>b||4<=b?null:B[b][a]}
function Ka(a,b){a=(a=Da(a,b))?a.level:0;a=1+64*(9+a%3)+(5>a?16:20);return H(a,a+4)}function Ca(a,b){a=Da(a,b);a=64*(1+(a?a.level:0)%6)+17;return H(a,a+6)};var La=[{s:"Ok hotshot, teleportation complete.\nSystem check. Do you remember the mission?",options:[{text:"ROGER",v:"dialog",T:4},{text:"UH WHAT?",v:"dialog",T:1}]},{s:"Mother frakking... Teleportation glitch.\nYou're a lost cause. Want advice anyway?",options:[{text:"YES",v:"dialog",T:2},{text:"NO",v:"dialog",T:3}]},{s:"Alright.  Your brain is mush, but we'll try.\nFind the blaster in the room.",options:[{text:"COPY",v:"quest",Z:0}]},{s:"Alright.  Your brain is mush, and you're\nballs deep in aliens who want to kill you.  Good luck.",
options:[{text:"BYE"}]},{s:"Good. How do you wanna run this, soldier?\nWant me to guide you, or comms off?",options:[{text:"GUIDE",v:"dialog",T:5},{text:"COMMS OFF",v:"dialog",T:6}]},{s:"Alright.  First things first:\nFind the blaster in the room.",options:[{text:"OK",v:"quest",Z:0}]},{s:"Alright.  You know what you're doing.\nGo get em.",options:[{text:"OVER AND OUT"}]},{s:"Good.  Radar shows alien blood nearby.\nGo kill that ugly bastard.",options:[{text:"ACCEPT",v:"quest",Z:1},{text:"IGNORE"}]},
{s:"Not bad, soldier.  That took guts.\nFind a BLUE key to get out of this sector.",options:[{text:"ACCEPT",v:"quest",Z:2},{text:"IGNORE"}]},{s:"Excellent.  Let's get the frak out of here.\nFind the BLUE door to move to the next sector.",options:[{text:"ACCEPT",v:"quest",Z:3},{text:"IGNORE"}]}],R=!1,Ma=0,Na=0,Oa;var Ga=[{title:"Find blaster",V:"item",i:2,W:7},{title:"First blood",V:"kill",i:1,W:8},{title:"Blue keycard",V:"item",i:3,W:9},{title:"Blue door",V:"item",i:3,W:9},{title:"Pick up radio",V:"item",i:4,W:0}],S=[];function Fa(a){Pa("Quest accepted: "+a.title,4294902015);S.push(a)}function Qa(a){Pa("Quest complete: "+a.title,4294902015);void 0!==a.W&&(a=a.W,R=!0,Oa=!1,Ma=a,Na=Ra)};var Sa=[];function Ta(a,b,d,c,e,f){Sa.push({ra:a,x:b,y:d,duration:c,ya:e,color:f,frame:0})};var z=null,Ua=0,Va=0,T=0,Ra=0,x=null,I=null,K=null,L=null,M=null,N=null,Wa=!1,Xa=!1,Ya=0,Za=0,U=0,V=0,W=null,k=null,$a=0;
function ab(a,b){if(N=Y(a,b))x.target=null,x.path=null;else if(a=r(q,a,b),a!==x.target){var d=x.x/16|0,c=x.y/16|0;x.target=a;a=x;a:{b=x.target;for(var e=q,f=0;f<e.height;f++)for(var h=0;h<e.width;h++){var l=e.f[f][h];l.K=Infinity;l.ma=Math.min(Math.abs(h-b.x),Math.abs(f-b.y));l.oa=null}d=q.f[c][d];d.K=0;for(d=[d];0<d.length;){c=null;e=-1;f=Infinity;for(h=0;h<d.length;h++)l=d[h],Infinity!==l.K&&l.K+l.ma<f&&(c=l,e=h,f=l.K+l.ma);d.splice(e,1);if(c.x===b.x&&c.y===b.y){b=[];for(d=c;d;)b.push(d),d=d.oa;
b.reverse();break a}for(e=0;e<ka.length;e++)if(f=c.x+ka[e],h=c.y+la[e],0<=f&&f<q.width&&0<=h&&h<q.height){l=q.f[h][f];var t=c.K+ma[e];t<l.K&&20>=t&&!q.f[h][f].A&&(l.K=t,l.oa=c,d.push(l))}}b=null}a.path=b;x.Y=0}}function bb(a){return a.x+16>=M.x&&a.y+16>=M.y&&a.x<M.x+z.width&&a.y<M.y+z.height&&q.G(a.x/16|0,a.y/16|0)}function Y(a,b){for(var d=0;d<I.length;d++){var c=I[d];if(!(0>=c.l)&&(c.x/16|0)===a&&(c.y/16|0)===b)return c}return null}
function Ea(a,b){for(var d=0;20>d;d++){for(var c=a-d;c<=a+d;c++){var e=b-d;if(!u(c,e)&&null===Y(c,e))return{fa:c,ga:e};e=b+d;if(!u(c,e)&&null===Y(c,e))return{fa:c,ga:e}}for(c=b-d;c<=b+d;c++){e=a-d;if(!u(e,c)&&null===Y(e,c))return{fa:e,ga:c};e=a+d;if(!u(e,c)&&null===Y(e,c))return{fa:e,ga:c}}}return null}
function Z(a,b,d,c){a.direction=c;var e=Math.hypot(b,d);c=Math.floor(a.x/16)+b/e;e=Math.floor(a.y/16)+d/e;if(u(c,e))return!1;if(c=Y(c,e)){if(a.i===c.i)return!1;cb(a,c,2);a.C=18;Ta(1,a.x,a.y,18);return!0}a.D=b;a.F=d;a.C=16/Math.max(Math.abs(b),Math.abs(d));return!0}
function cb(a,b,d){b.l-=d;Ta(2,b.x+8,b.y-4,40,d.toString(),4278190335);if(0>=b.l&&(b.l=0,Pa(b.name+" died",4278190335),b===N&&(N=null),0===a.i)){a=10*b.level;x.R+=a;for(Ta(2,x.x+8,x.y-4,40,"+"+a,4278255615);x.R>=x.S;)x.R-=x.S,x.S*=2,x.level++,Pa("You are now level "+x.level,16711935);for(a=S.length-1;0<=a;a--)d=S[a],"kill"===d.V&&d.i===b.i&&(S.splice(a,1),Qa(d))}}function Pa(a,b){L.push({text:a,color:b});5<L.length&&L.splice(0,L.length-5)}
function db(){0===T&&I.sort(function(a,d){return Math.hypot(a.x-x.x,a.y-x.y)-Math.hypot(d.x-x.x,d.y-x.y)});T++;if(T>=I.length)for(var a=T=0;a<I.length;a++)0<I[a].l&&(I[a].m=1)}function eb(a){if(R){var b=La[Ma];0>a||a>b.options.length||(a=b.options[a],"dialog"===a.v?(a=a.T,R=!0,Oa=!1,Ma=a,Na=Ra):"quest"===a.v?(R=!1,Fa(Ga[a.Z])):R=!1)}}
function fb(){if(R){if(!(30>Ra-Na)){var a=(z.width-160)/2|0,b=(z.height-160)/2|0;1===W[32].u?Oa=!0:1===W[49].u||1===k.u&&ja(a,b+64,80,8)?eb(0):(1===W[50].u||1===k.u&&ja(a,b+80,80,8))&&eb(1)}}else if(Wa)1===W[78].h&&(Wa=!1);else if(0<x.l)for(;;){a=I[T];if(0<a.m&&0===a.C)if(0===T)a:if(0>=x.l)x.m=0;else{var d=x.x/16|0;b=x.y/16|0;var c=!1;if(0!==k.D||0!==k.F)Ya=k.x,Za=k.y,U=(M.x+Ya)/16|0,V=(M.y+Za)/16|0;if(Xa){if(1===W[98].h||1===W[40].h)Za+=16,V++;else if(1===W[100].h||1===W[37].h)Ya-=16,U--;else if(1===
W[102].h||1===W[39].h)Ya+=16,U++;else if(1===W[104].h||1===W[38].h)Za-=16,V--;else{if(1===W[27].h){x.target=null;x.path=null;Xa=!1;break a}1===W[13].h?Xa=!1:1===W[50].h&&(x.x=16*U,x.y=16*V,x.m=0,x.C=1,Xa=!1)}ab(U,V)}else{if(k.j)if(k.y>z.height-24)0<=k.x&&32>k.x&&(c=!0);else{ab((M.x+k.x)/16|0,(M.y+k.y)/16|0);break a}if(1===W[9].h){b=N?I.indexOf(N):0;for(var e=b+1;0===e||e>=I.length||0>=I[e].l||!bb(I[e]);)if(e++,e>=I.length&&(e=0),e===b){e=-1;break}0<e?N=I[e]:N=null}else if(1===W[13].h)Ya=x.x-M.x,Za=
x.y-M.y,U=x.x/16|0,V=x.y/16|0,Xa=!0,N=null;else if(1===W[78].h)Wa=!0;else{e=null;if(x.path){for(e=x.path[x.Y];e&&e.x===d&&e.y===b;)x.Y++,e=x.Y<x.path.length?x.path[x.Y]:null;e||(x.target=null,x.path=null)}var f=W[100].j||W[37].j||e&&e.x<d;d=W[102].j||W[39].j||e&&e.x>d;var h=W[104].j||W[38].j||e&&e.y<b,l=W[101].j;c=1===W[49].h||c;W[98].j||W[40].j||e&&e.y>b?Z(x,0,x.H,2):f?Z(x,-x.H,0,3):l?x.m=0:d?Z(x,x.H,0,1):h?Z(x,0,-x.H,0):c&&N&&0<x.da&&(Ta(1,N.x,N.y,18),x.C=36,cb(x,N,5),x.da--)}}}else 0>=a.l?a.m=
0:bb(a)?x.x<a.x&&Z(a,-a.H,0,3)||x.x>a.x&&Z(a,a.H,0,1)||x.y<a.y&&Z(a,0,-a.H,0)||x.y>a.y&&Z(a,0,a.H,2)||0!==a.D||0!==a.F||(a.m=0):a.m=0;if(0<a.C){if(0!==a.D||0!==a.F)a.x+=a.D,a.y+=a.F;a.C--;if(0===a.C&&(a.D=0,a.F=0,a.m--,0===a.i)){for(b=K.length-1;0<=b;b--)if(e=K[b],e.x===a.x&&e.y===a.y)for(K.splice(b,1),x.xa.push(e),Pa("Picked up: "+e.name,16777215),f=S.length-1;0<=f;f--)c=S[f],"item"===c.V&&c.i===e.i&&(S.splice(f,1),Qa(c));ua()}}0>=a.m&&(a.m=0,db());if(0===T&&0<a.m)break;if(0<a.C)break}W[65].j&&($a=
10);Va++;16<Va&&(Va=0,Ua++);if(z.c.aa&&z.c.aa.loaded){M.x=Math.max(0,x.x-(z.width/2|0)+8);M.y=Math.max(0,x.y-(z.height/2|0)+8);0<$a--&&(M.x+=4*Math.random()-2,M.y+=4*Math.random()-2);if(R){if(R&&(a=(z.width-160)/2|0,b=(z.height-160)/2|0,P(a+64,b,128,608,32,32),e=La[Ma],f=Ra-Na,f=Oa?e.s.length:Math.min(e.s.length,Math.floor(f/2)),y(e.s.substr(0,f),a,b+32,void 0),f===e.s.length))for(f=0;f<e.options.length;f++)y(e.options[f].text,a,b+64+16*f,void 0)}else{a=q;b=M.x;e=M.y;h=z.width;l=z.height;f=a.O;f.enable(f.BLEND);
f.blendFunc(f.SRC_ALPHA,f.ONE_MINUS_SRC_ALPHA);f.useProgram(a.a);f.bindBuffer(f.ARRAY_BUFFER,a.ia);f.enableVertexAttribArray(a.ha);f.enableVertexAttribArray(a.ca);f.vertexAttribPointer(a.ha,2,f.FLOAT,!1,16,0);f.vertexAttribPointer(a.ca,2,f.FLOAT,!1,16,8);a.U[0]=h;a.U[1]=l;f.uniform2fv(a.va,a.U);f.activeTexture(f.TEXTURE0);f.uniform1i(a.ka,0);f.activeTexture(f.TEXTURE1);f.uniform1i(a.la,1);c=b/16|0;d=e/16|0;h=(b+h)/16|0;l=(e+l)/16|0;for(var t=0;t<a.b.length;t++){for(var m=a.b[t],p=d;p<=l;p++)for(var C=
c;C<=h;C++){var w=a.G(C,p)?255:(w=r(a,C,p))&&w.pa?144:0;m.P[4*(p*m.width+C)+3]=w}f.uniform2f(a.ua,b,e);f.uniform2fv(a.ja,m.wa);f.bindTexture(f.TEXTURE_2D,m.qa);f.texSubImage2D(f.TEXTURE_2D,0,0,0,m.width,m.height,f.RGBA,f.UNSIGNED_BYTE,m.P);f.drawArrays(f.TRIANGLES,0,6)}x.target&&(a=16*x.target.x-M.x,b=16*x.target.y-M.y,e=640,u(x.target.x,x.target.y)&&(e=688),P(a,b,e,176,16,16));for(a=0;a<K.length;a++)b=K[a],bb(b)&&P(b.x-M.x,b.y-M.y,16*Ha[b.i],16*Ia[b.i],16,16);for(a=0;a<I.length;a++)b=I[a],bb(b)&&
(e=b.x-M.x,f=b.y-M.y,0>=b.l?(c=496,d=432):(c=16*(Ha[b.i]+Ja[b.direction]),d=16*(Ia[b.i]+Ua%2)),b===N&&P(e,f,720,176,16,16),P(e,f,c,d,16,16));for(a=Sa.length-1;0<=a;a--)b=Sa[a],e=b.x-M.x,f=b.y-M.y,1===b.ra?P(e,f,128+16*Math.floor(b.frame/6),304,16,16):2===b.ra&&Q(b.ya,e,f-Math.min(4,Math.floor(b.frame/2)),b.color),b.frame++,b.frame>=b.duration&&Sa.splice(a,1);for(b=a=0;b<I.length;b++)e=I[b],e!==x&&0>=e.l||!bb(e)||(e===x?(f=e.l/e.X,y(e.name,0,a,void 0),P(0,a+7,544,208,32,12),P(2,a+9,544,224,8,8,void 0,
Math.round(28*f)),y(e.l+"/"+e.X,3,a+10,void 0),f=x.da/x.sa,y("AMMO",32,a,void 0),P(32,a+7,544,208,32,12),P(34,a+9,552,224,8,8,void 0,Math.round(28*f)),y(e.da+"/"+e.sa,35,a+10,void 0),f=x.R/x.S,y("LEVEL "+x.level,64,a,void 0),P(64,a+7,544,208,32,12),P(66,a+9,568,224,8,8,void 0,Math.round(28*f)),y(e.R+"/"+e.S,67,a+10,void 0)):(f=e.l/e.X,y(e.name,0,a,void 0),P(0,a+7,544,208,32,12),P(2,a+9,560,224,8,8,void 0,Math.round(28*f)),y(e.l+"/"+e.X,3,a+10,void 0)),a+=24);if(0<S.length)for(y("OBJECTIVES:",z.width-
60,0,void 0),a=0;a<S.length;a++)y(S[a].title,z.width-60,8+8*a,void 0);a=z.height-24-8*L.length;for(b=0;b<L.length;b++)y(L[b].text,0,a+8*b,L[b].color);for(a=0;6>a;a++)P(24*a,z.height-24,512,208,24,24),0===a&&P(24*a+4,z.height-24+4,256,448,16,16);Wa&&(P(0,0,512,256,144,144,128,z.width,z.height),a=(z.width-144)/2|0,b=(z.height-144)/2|0,P(a,b,512,256,144,144),P(a+10,b+9,480,416,16,16),y("2",a+21,b+19,16711935),P(a+22,b+33,464,416,16,16),y("0",a+33,b+43,16711935),P(a+22,b+57,624,160,16,16),y("0",a+33,
b+67,16711935),P(a+22,b+81,448,416,16,16),y("0",a+33,b+91,16711935),P(a+56,b+9,336,416,16,16),y("0",a+67,b+19,16711935),P(a+68,b+33,336,448,16,16),y("0",a+79,b+43,16711935),P(a+68,b+57,272,400,16,16),y("0",a+79,b+67,16711935),P(a+68,b+81,400,432,16,16),y("0",a+79,b+91,16711935),P(a+102,b+9,128,354,16,16),y("0",a+113,b+19,16711935),P(a+114,b+33,592,160,16,16),y("0",a+125,b+43,16711935),P(a+114,b+57,272,400,16,16),y("0",a+125,b+67,16711935),P(a+114,b+81,352,400,16,16),y("0",a+125,b+91,16711935),y("1: Leap 2 squares",
a+8,b+106,4294967295),y("2: Leap 3 squares",a+8,b+114,4294967295),y("3: Leap 4 squares",a+8,b+122,16711935),y("4: Leap 5 squares",a+8,b+130,2155905279))}Ra++}};var gb=new Audio("https://static.cody.xyz/syndicate.lubiki.pl/synd_music_ingame_standard_final_mq.mp3");function hb(){Q("STACIO",z.a.x,30);P(z.a.x-16,z.a.y-16,640,208,32,32);if(1===z.keys[13].h||1===z.g.u)z.update=ib}function ib(){Q("STACIO",z.a.x,30);Q("NEW GAME",z.a.x,80);Q("CONTINUE",z.a.x,90,2155905279);Q("ENTER SEED",z.a.x,100);Q("TUTORIAL",z.a.x,110);Q("HIGH SCORES",z.a.x,120);Q("CREDITS",z.a.x,130);if(1===z.keys[13].h||1===z.g.u)z.update=ja(z.a.x-20,130,40,10)?jb:fb}
function jb(){Q("STACIO",z.a.x,30);var a=z.a.x-40;y("CODE AND DESIGN:",a,60,void 0);y("CODY.XYZ",a+10,70,void 0);y("GRAPHICS:",a,90,void 0);y("ORYX DEISGN LAB",a+10,100,void 0);y("oryxdesignlab.com",a+10,110,void 0);y("MUSIC:",a,130,void 0);y("ERIC MATYAS",a+10,140,void 0);y("WWW.SOUNDIMAGE.ORG",a+10,150,void 0);if(1===z.keys[13].h||1===z.g.u)z.update=ib}
(function(){function a(){b.removeEventListener("click",a);gb.loop=!0;gb.play()}var b=document.querySelector("canvas");b.addEventListener("click",a);z=new za(b);z.update=hb;W=z.keys;k=z.g})();
